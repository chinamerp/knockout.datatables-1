(function(n,t){t.gridModel=function(n){function r(t){console.log("Request "+i.pageSize()+"rows");n(i,t).done(function(n,t){i.totalRows(t);i.items(n)})}function c(){for(var t,u=["page","pageSize","sortField","sortOrder"],f=function(n){return function(t){r({field:n,newValue:t})}},n=0,e=u.length;n<e;n++)t=u[n],i[t].subscribe(f(t))}function l(){}function a(){}var u=t.observable(1),f=t.observable(20).extend({throttle:0}),e=t.observable().extend({throttle:0}),o=t.observable("ASC").extend({throttle:0}),s=t.observable(),h=t.observableArray(),i={page:u,pageSize:f,sortField:e,sortOrder:o,totalRows:s,items:h,load:l,store:a};return c(),r(),i};t.gridModel.inMemory=function(i){return t.gridModel(function(r,u){var f=n.Deferred();return setTimeout(function(){var h=parseInt(r.pageSize()*(r.page()-1)),c=parseInt(r.pageSize()*r.page()),s=[],n,o,e;for(u&&u.field!=="sortField"&&u.field!=="sortOrder"||(n=r.sortField(),o=r.sortOrder()==="asc"?-1:1,i.sort(function(i,r){return t.unwrap(i[n])<t.unwrap(r[n])?o:t.unwrap(i[n])>t.unwrap(r[n])?-o:0})),e=h;e<c&&e<i.length;e++)s.push(i[e]);f.resolve(s,i.length)},0),f})};t.dtColumn=function(n,t){function r(n,t){return t==="display"?i.name||"$data":t==="filter"||t==="sort"?i.name:t==="set"?void 0:function(){return n[i.name]||n}}function u(n,t){return function(i,r){return r==="display"?"":n||'<td data-bind="text: '+(t||"$data")+'"><\/td>'}}var i;return i=arguments.length===2||arguments.length===1&&typeof n=="string"?{name:n,displayName:t}:n,{data:r,render:u(i.template,i.name),title:i.displayName||i.name,sortable:!!i.name}};t.bindingHandlers.datatables={init:function(i,r,u,f,e){function h(r){var u=n("<tr>"),f,e;t.utils.arrayForEach(r,function(n){u.append(n.render())});f=u[0].childNodes;e=t.utils.moveCleanedNodesToContainerElement(f);new t.templateSources.anonymousTemplate(i).nodes(e)}function c(n){return n.dom?n.dom:(n.allowColumnReorder===!0?"R":"")+"Tti"+(n.virtualScrolling===!0?"S":"p")}function l(r){var u={aButtons:[]},h=function(t){var u=r.datasource.items.indexOf(t),f=n.fn.dataTable.TableTools.fnGetInstance(i);return i.rows[u+1]},e=function(n){var i=n&&n.cells[0];return i&&t.dataFor(i)},o=function(r){return function(u){u&&setTimeout(function(){var e=n.fn.dataTable.TableTools.fnGetInstance(i),o=u instanceof Array?u:[u],s=t.utils.arrayMap(o,h),c=e.fnGetSelected(),f=[];t.utils.arrayForEach(s,function(t){t&&(r==="fnDeselect"||n(c).index(t)===-1)&&f.push(t)});f.length>0&&e[r](f)},0)}},s=function(t){var f,e;if(t.keyCode===40||t.keyCode===38){var r=n(i).find("tbody tr"),o=r.index(t.target),u=o+(t.keyCode-39);if(u>=0&&u<=r.length)return f=r.eq(u)[0],e=n.fn.dataTable.TableTools.fnGetInstance(i),e.fnSelect(f),!1}},f;return t.isObservable(r.selected)?(r.selected.push?(f=function(n){return function(t){var i=e(t[0]);r.selected[n](i)}},u.sRowSelect="multi",u.fnRowDeselected=f("remove"),u.fnRowSelected=f("push")):(u.sRowSelect="single",u.fnRowDeselected=function(t){r.selected()&&r.selected()===e(t[0])&&r.selected(undefined);r.tabIndex&&n(t[0]).removeAttr("tabindex").off("keydown",s)},u.fnRowSelected=function(t){var i=e(t[0]);if(i!==r.selected()&&r.selected(i),r.tabIndex)n(t[0]).attr("tabindex",r.tabIndex).focus().on("keydown",s)}),r.selected.subscribe(o("fnDeselect"),null,"beforeChange"),r.selected.subscribe(o("fnSelect"))):typeof r.selected=="string"&&(f=function(n){return function(t){for(var u,f=t instanceof Array?t:[t],i=0;i<f.length;i++)u=e(f[i]),u&&u[r.selected](n)}},u.sRowSelect="multi",u.fnRowSelected=f(!0),u.fnRowDeselected=f(!1),r.datasource.items.filter(function(n){return n[r.selected]()===!0}).subscribe(o("fnSelect")),r.datasource.items.filter(function(n){return n[r.selected]()===!1}).subscribe(o("fnDeselect"))),u}function a(t){if(t.scrollY)if(typeof t.scrollY=="function"){var r=function(){var r=n(i).parent();r.length>0&&r.height(n.proxy(t.scrollY,r)())};n(window).resize(r);setTimeout(function(){n(i).dataTable()._fnAdjustColumnSizing(!0);r()},100);try{return t.scrollY()||500}catch(u){return 500}}else return t.scrollY}function v(){}var o=r(),s={columnDefs:n.each(o.columns,function(n,t){t.targets=[n]}),displayLength:o.datasource.pageSize(),displayStart:o.datasource.pageSize()*(o.datasource.page()-1),serverSide:!0,dom:c(o),deferRender:o.deferRender||o.virtualScrolling,scrollY:a(o),oTableTools:l(o)};h(s.columnDefs);s.serverData=function(n,t){var r=t.start,i=t.length,u=r/i+1,f=o.columns[t.order[0].column].data(undefined,"sort"),e=t.order[0].dir;o.datasource.page(u);o.datasource.pageSize(i);o.datasource.sortField(f);o.datasource.sortOrder(e)};s.rowCallback=function(n,r,u){var f=e.createChildContext(t.unwrap(r),s.as);return f.$index=t.observable(u),t.renderTemplate(o.rowTemplate||i,f,{},n,"replaceChildren"),o.rowCallback&&o.rowCallback(n,r),n};n(i).dataTable(s).on("column-reorder",v);o.datasource.items.subscribe(function(r){var e=n(i).dataTable(),h=e.api(),f=h.rows().nodes(),u,s;if(f.length)for(u=0,s=f.length;u<s;u++)t.cleanNode(f[u]);e._fnAjaxUpdateDraw({aaData:r,iTotalRecords:o.datasource.totalRows(),iTotalDisplayRecords:o.datasource.totalRows()})})}}})(window.$,window.ko);
/*
//# sourceMappingURL=knockout.datatables.min.js.map
*/