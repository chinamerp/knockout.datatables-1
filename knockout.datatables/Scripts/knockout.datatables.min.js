(function(n,t){t.gridModel=function(i){function a(){f()&&(w(c,r)||e)&&(c=l(r),e=!1,u(!0),n.proxy(i,r)().done(function(n,t){o.totalRows(t);o.items(n)}).always(function(){u(!1)}))}function v(n){var f=JSON.parse(sessionStorage.getItem(h+n)),u,i;for(u in f)i=r[u],t.isWriteableObservable(i)&&!t.isComputed(i)&&i(f[u]);return s}function y(n){var f={},u,i;for(u in r)i=r[u],t.isObservable(i)&&!t.isComputed(i)&&(f[u]=t.unwrap(i));sessionStorage.setItem(h+n,JSON.stringify(f))}function p(t){return t=n.extend({},{force:!1},t),e=t.force,f(!0),f.notifySubscribers(!0),s}function w(n,i){for(var r in i)if(t.unwrap(n[r])!==t.unwrap(i[r]))return!0;return!1}function l(n){var i={};for(var r in n)i[r]=t.unwrap(n[r]);return i}var h="__ko_gridModel_",r={skip:t.observable(0),top:t.observable(20),sortField:t.observable(),sortOrder:t.observable("ASC")},u=t.observable(!1),c=l(r),f=t.observable(!1),e=!1,o={items:t.observableArray(),totalRows:t.observable()},s;return t.computed(a,r).extend({rateLimit:0}),s={parameters:r,result:o,load:v,store:y,fetch:p,fetchInProgress:u}};t.gridModel.inMemory=function(i){return t.gridModel(function(){var u=n.Deferred(),e=this.skip(),o=this.skip()+this.top(),r=this.sortField(),f=this.sortOrder()==="asc"?-1:1;return setTimeout(function(){var s=[],n;for(i.sort(function(n,i){return t.unwrap(n[r])<t.unwrap(i[r])?f:t.unwrap(n[r])>t.unwrap(i[r])?-f:0}),n=e;n<o&&n<i.length;n++)s.push(i[n]);u.resolve(s,i.length)},0),u})};t.dtColumn=function(n,t){function r(n,t){return t==="display"?i.name||"$data":t==="filter"||t==="sort"?i.name:t==="set"?void 0:function(){return n[i.name]||n}}function u(n,t){return function(i,r){return r==="display"?"":n||'<td data-bind="text: '+(t||"$data")+'"><\/td>'}}var i;return i=arguments.length===2||arguments.length===1&&typeof n=="string"?{name:n,displayName:t}:n,{data:r,render:u(i.template,i.name),title:i.displayName||i.name,sortable:!!i.name}};t.bindingHandlers.datatables={defaults:{},init:function(i,r,u,f,e){function a(n){for(var r=n.datasource.parameters.sortField(),u=n.datasource.parameters.sortOrder(),i=0,t=0,f=n.columns.length;t<f;t++)if(n.columns[t].data(undefined,"sort")===r){i=t;break}return[i,u]}function v(r){var u=n("<tr>"),f,e;t.utils.arrayForEach(r,function(n){u.append(n.render())});f=u[0].childNodes;e=g(f);new t.templateSources.anonymousTemplate(i).nodes(e)}function y(n){return n.dom?n.dom:(n.allowColumnReorder===!0?"R":"")+"Tti"+(n.virtualScrolling===!0?"S":"p")}function p(r){var u={aButtons:[]},l=function(t){var u=r.datasource.result.items.indexOf(t),e,f;if(u!==-1)return e=n.fn.dataTable.TableTools.fnGetInstance(i),f=i.rows[u+1],f},e=function(n){var i=n&&n.cells[0];return i&&t.dataFor(i)},o=function(r){return function(u){u&&setTimeout(function(){var e=n.fn.dataTable.TableTools.fnGetInstance(i),o=u instanceof Array?u:[u],s=t.utils.arrayMap(o,l),h=e.fnGetSelected(),f=[];t.utils.arrayForEach(s,function(t){t&&(r==="fnDeselect"||n(h).index(t)===-1)&&f.push(t)});f.length>0&&e[r](f)},0)}},c=function(t){var f,e;if(t.keyCode===40||t.keyCode===38){var r=s.find("tbody tr"),o=r.index(t.target),u=o+(t.keyCode-39);if(u>=0&&u<=r.length)return f=r.eq(u)[0],f&&(e=n.fn.dataTable.TableTools.fnGetInstance(i),e.fnSelect(f)),!1}},f;if(t.isObservable(r.selected)){r.selected.push?(f=function(n){return function(t){var i=e(t[0]);r.selected[n](i)}},u.sRowSelect="multi",u.fnRowDeselected=f("remove"),u.fnRowSelected=f("push")):(u.sRowSelect="single",u.fnRowDeselected=function(t){r.selected()&&r.selected()===e(t[0])&&r.selected(undefined);r.tabIndex&&n(t[0]).removeAttr("tabindex").off("keydown",c)},u.fnRowSelected=function(t){var i=e(t[0]);if(i!==r.selected()&&r.selected(i),r.tabIndex)n(t[0]).attr("tabindex",r.tabIndex).focus().on("keydown",c)});h.push(r.selected.subscribe(o("fnDeselect"),null,"beforeChange"));h.push(r.selected.subscribe(o("fnSelect")));s.on("reloaded",function(){r.selected.valueHasMutated()})}else typeof r.selected=="string"&&(f=function(n){return function(t){for(var u,f=t instanceof Array?t:[t],i=0;i<f.length;i++)u=e(f[i]),u&&u[r.selected](n)}},u.sRowSelect="multi",u.fnRowSelected=f(!0),u.fnRowDeselected=f(!1),h.push(r.datasource.result.items.filter(function(n){return n[r.selected]()===!0}).subscribe(o("fnSelect"))),h.push(r.datasource.result.items.filter(function(n){return n[r.selected]()===!1}).subscribe(o("fnDeselect"))));return u}function w(t){if(t.scrollY)if(typeof t.scrollY=="function"){var i=function(){var i=s.parent();i.length>0&&i.height(n.proxy(t.scrollY,i)())};n(window).resize(i);setTimeout(function(){s.dataTable()._fnAdjustColumnSizing(!0);i()},100);try{return t.scrollY()||500}catch(r){return 500}}else return t.scrollY}function b(){}function k(t){var i=n.extend({},t,{columnDefs:n.each(t.columns,function(n,t){t.targets=[n]}),displayLength:t.datasource.parameters.top(),displayStart:t.datasource.parameters.skip(),serverSide:!0,dom:y(t),deferRender:t.deferRender||t.virtualScrolling,order:t.order||a(t),scrollY:w(t),oTableTools:p(t),initComplete:function(n){t.virtualScrolling&&n.oScroller.fnScrollToRow(t.datasource.parameters.skip())}});return delete i.datasource,delete i.columns,delete i.virtualScrolling,delete i.selected,delete i.loadingTemplate,i}function d(t){var i=n("#table-loader"),r,u,f,e;t?(r=s.parent(),i.length||(u=document.getElementById(o.loadingTemplate),i=n(u.innerHTML).attr({id:"table-loader"}).css({position:"absolute","z-index":1,left:0,right:0}),r.append(i)),f=r.scrollTop(),e=r.height(),i.css({top:f,height:e}).show()):i.hide()}function g(n){for(var r=nt(n),u=document.createElement("div"),i=0,f=r.length;i<f;i++)u.appendChild(t.cleanNode(r[i]));return u}function nt(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i}var s=n(i),h=[],o=n.extend({},t.bindingHandlers.datatables.defaults,r()),c=k(o),l=t.utils.supressFeedbackScope();v(c.columnDefs);c.serverData=function(n,t){l.supressFeedback(function(){var n=t.order&&o.columns[t.order[0].column].data(undefined,"sort"),i=t.order&&t.order[0].dir;o.datasource.parameters.skip(t.start);o.datasource.parameters.top(t.length);o.datasource.parameters.sortField(n);o.datasource.parameters.sortOrder(i);o.datasource.fetch()})};c.rowCallback=function(n,r,u){var f=e.createChildContext(t.unwrap(r),c.as);return f.$index=t.observable(u),n.innerHTML="",t.renderTemplate(o.rowTemplate||i,f,{},n,"replaceChildren"),o.rowCallback&&o.rowCallback(n,r),n};s.dataTable(c).on("column-reorder",b);h.push(o.datasource.result.items.subscribe(function(n){var u=s.dataTable(),e=u.api(),r=e.rows().nodes(),i,f;if(r.length)for(i=0,f=r.length;i<f;i++)t.cleanNode(r[i]);u._fnAjaxUpdateDraw({aaData:n,iTotalRecords:o.datasource.result.totalRows(),iTotalDisplayRecords:o.datasource.result.totalRows()});s.trigger("reloaded")}));h.push(o.datasource.parameters.skip.subscribe(function(n){l.supressFeedback(function(){var t=o.datasource.parameters,i=s.dataTable().api();i.page(n/t.top()).draw(!1)})}));o.loadingTemplate&&h.push(o.datasource.fetchInProgress.subscribe(d));t.utils.domNodeDisposal.addDisposeCallback(i,function(){for(var n=0;n<h.length;n++)h[n].dispose();s.dataTable().api().destroy()})}};t.utils.supressFeedbackScope=function(){var n=!1;return{supressFeedback:function(t){if(!n){n=!0;try{t()}finally{n=!1}}}}}})(window.$,window.ko);
/*
//# sourceMappingURL=knockout.datatables.min.js.map
*/